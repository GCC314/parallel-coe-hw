# 并行程序设计 第二次作业

` 2100011047 工学院 陈国赐 `


## 任务1

> 找到`abacus-develop`这个目录下占硬盘最大的文件夹（提示：`du`）

目录下占硬盘最大的必然是一级子文件夹，故我们只需要加上`--max-depth`参数即可。

命令和运行结果如下：

```bash
du --max-depth 1
```

```plaintext
12      ./conda
102488  ./.git
8       ./.devcontainer
36976   ./source
9992    ./examples
556     ./docs
12      ./deps
4536    ./tools
36      ./cmake
74804   ./tests
64      ./.github
229564  .
```

除去当前目录`./`，最大的子文件夹是`.git/`。

## 任务2

> 找到后缀名为`.cpp`的文件，统计一共有多少个（提示：`find`），将其文件名输出。

先输出`.cpp`的文件名，因为文件较多我们考虑输出到文件`task2.out`，命令如下：

```bash
find . -name *.cpp > task2.out
```

输出在作业的附加文件中。

再考虑统计个数，用管道传送到`wc`中即可，命令如下：

```bash
find . -name *.cpp | wc -l
```

输出如下：

```plaintext
621
```

故有621个`.cpp`文件。

## 任务3

> 找到程序包里大于10kb的文件，将其文件名输出。（提示`find`）

考虑到`find`的`-size`参数，
即可得到命令如下：

```bash
find . -size +10k > task3.out
```

输出在附加文件中。

共有606个符合要求的文件。


## 任务4

> 任务4：统计在`abacus-develop/source/module_io`文件夹里，“write”这个单词出现了多少次。要求把操作的每一个命令和得到结果写下来提交。（提示：`grep`+`awk`）

首先，`grep`命令在给定的文件中会匹配字串并输出匹配到的行，并高亮每行中匹配的串。

指定`-r`选项会使`grep`在给定目录下递归的对每个文件进行匹配，这是我们所需要的。

需要注意的是，一行中可能有多个匹配，而`grep`在默认情况下以行为单位输出。我们需要指定`-o`选项，此时只会输出匹配到的部分，且每个匹配到的部分占一行，这样每一行都对应了某个文件中的一个write了。

然后我们只需要统计输出有多少行，其实这里可以直接用`wc -l`，但我们也可以用`awk`统计，只不过略显麻烦。

总命令如下：
```bash
grep -r -o write ./source/module_io | awk -var=a '{a+=1}END{print a}'
```

输出如下：
```plaintext
241
```
即目录下所有文件中共出现了241次'write'。

## 任务5

> 任务5：统计软件包里有多少行C++代码（提示：以上命令再加`wc`）

我们要完成的是三个子功能：

1.获取所有`.cpp`文件的路径
2.统计每个文件的行数
3.将和累加并输出

第二个功能由`wc`命令实现，统计文件`fname`的行数可以用命令`wc -l fname`。

第一个功能可以由`find`实现，且我们要考虑如何对`find`找到的每个文件都执行对应的`wc`命令。
考虑到`find`命令的`-exec`参数，可以对`find`找到的每个文件执行相应的命令。

最后用`awk`对`wc`输出中的行数进行累加并输出总和。综合三者，命令如下：

```bash
find . -name *.cpp -exec wc -l {} \; | awk -var=a '{a+=$1;}END{print a}'
```

输出为：

```plaintext
224172
```

即`.cpp`文件总共有`224172`行。